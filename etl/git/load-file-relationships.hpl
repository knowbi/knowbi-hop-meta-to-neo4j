<?xml version="1.0" encoding="UTF-8"?>
<pipeline>
  <info>
    <name>load-file-relationships</name>
    <name_sync_with_filename>N</name_sync_with_filename>
    <description/>
    <extended_description/>
    <pipeline_version/>
    <pipeline_type>Normal</pipeline_type>
    <pipeline_status>0</pipeline_status>
    <parameters>
    </parameters>
    <capture_transform_performance>N</capture_transform_performance>
    <transform_performance_capturing_delay>1000</transform_performance_capturing_delay>
    <transform_performance_capturing_size_limit>100</transform_performance_capturing_size_limit>
    <created_user>-</created_user>
    <created_date>2020/03/18 11:13:55.130</created_date>
    <modified_user>-</modified_user>
    <modified_date>2020/03/18 11:13:55.130</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA=</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
  </notepads>
  <order>
    <hop>
      <from>filter-hash</from>
      <to>sort-commit-file</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>read-git-commit-details</from>
      <to>get-project-dir</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>sort-commit-file</from>
      <to>filter-filename</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>filter-filename</from>
      <to>switch-label</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>switch-label</from>
      <to>write-commitoperation-file</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>switch-label</from>
      <to>block-until-commit-file</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>switch-label</from>
      <to>block-until-commit-pipeline</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>block-until-commit-file</from>
      <to>write-commitoperation-pipeline</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>block-until-commit-pipeline</from>
      <to>write-commitoperation-workflow</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>get-project-dir</from>
      <to>calc-file</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>calc-file</from>
      <to>replace-slash</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>replace-slash</from>
      <to>filter-hash</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <transform>
    <name>block-until-commit-file</name>
    <type>BlockUntilTransformsFinish</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <transforms>
      <transform>
        <name>write-commitoperation-file</name>
      </transform>
    </transforms>
    <attributes/>
    <GUI>
      <xloc>1549</xloc>
      <yloc>256</yloc>
    </GUI>
  </transform>
  <transform>
    <name>block-until-commit-pipeline</name>
    <type>BlockUntilTransformsFinish</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <transforms>
      <transform>
        <name>write-commitoperation-pipeline</name>
      </transform>
    </transforms>
    <attributes/>
    <GUI>
      <xloc>1346</xloc>
      <yloc>384</yloc>
    </GUI>
  </transform>
  <transform>
    <name>calc-file</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>
var operations = {
	M: 'MODIFIES',
	A: 'ADDS',
	D: 'DELETES',
	R: 'RENAMES',
	C: 'COPIES',
	U: 'UPDATES',
	R100: 'RENAMES'
};

var file = null;
var operation = null;
var extension = null;
var name = null;
var filename = null;
var hash;
var label = 'File'; 

if(status.slice(-1)==";")
{
 	hash=status.replace(";",'')
	label = 'Hash'; 
}
else
{
	file = files.replace(/^.*[\\\/]/, '')

	operation = operations[status];

	extension = files.split('.').pop();

	name = file.split('.').slice(0, -1).join('.');

	filename=PROJECT_DIR+'\\'+files

	if(file.endsWith('.hpl')){
 		 label = 'Pipeline'; 
	}
	if(file.endsWith('hwf')){
  		label = 'Workflow'; 
	}
}</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>file</name>
        <rename>file</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>operation</name>
        <rename>operation</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>extension</name>
        <rename>extension</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>name</name>
        <rename>name</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>hash</name>
        <rename>hash</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>label</name>
        <rename>label</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>filename</name>
        <rename>filename</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>534</xloc>
      <yloc>128</yloc>
    </GUI>
  </transform>
  <transform>
    <name>filter-filename</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to/>
    <send_false_to/>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>name</leftvalue>
        <function>IS NOT NULL</function>
        <rightvalue/>
      </condition>
    </compare>
    <attributes/>
    <GUI>
      <xloc>1346</xloc>
      <yloc>128</yloc>
    </GUI>
  </transform>
  <transform>
    <name>filter-hash</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <send_true_to/>
    <send_false_to/>
    <compare>
      <condition>
        <negated>N</negated>
        <leftvalue>label</leftvalue>
        <function>&lt;></function>
        <rightvalue/>
        <value>
          <name>constant</name>
          <type>String</type>
          <text>Hash</text>
          <length>-1</length>
          <precision>-1</precision>
          <isnull>N</isnull>
          <mask/>
        </value>
      </condition>
    </compare>
    <attributes/>
    <GUI>
      <xloc>940</xloc>
      <yloc>128</yloc>
    </GUI>
  </transform>
  <transform>
    <name>get-project-dir</name>
    <type>GetVariable</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>PROJECT_DIR</name>
        <variable>${PROJECT_DIR}</variable>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>331</xloc>
      <yloc>128</yloc>
    </GUI>
  </transform>
  <transform>
    <name>read-git-commit-details</name>
    <type>TextFileInput2</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <accept_filenames>N</accept_filenames>
    <passing_through_fields>N</passing_through_fields>
    <accept_field/>
    <accept_transform_name/>
    <separator>	</separator>
    <enclosure>"</enclosure>
    <enclosure_breaks>N</enclosure_breaks>
    <escapechar/>
    <header>N</header>
    <nr_headerlines>1</nr_headerlines>
    <footer>N</footer>
    <nr_footerlines>1</nr_footerlines>
    <line_wrapped>N</line_wrapped>
    <nr_wraps>1</nr_wraps>
    <layout_paged>N</layout_paged>
    <nr_lines_per_page>80</nr_lines_per_page>
    <nr_lines_doc_header>0</nr_lines_doc_header>
    <noempty>Y</noempty>
    <include>N</include>
    <include_field/>
    <rownum>N</rownum>
    <rownumByFile>N</rownumByFile>
    <rownum_field/>
    <format>mixed</format>
    <encoding/>
    <length>Characters</length>
    <add_to_result_filenames>Y</add_to_result_filenames>
    <file>
      <name>${GIT_TMP_DIR}/gp-commit-details.csv</name>
      <filemask/>
      <exclude_filemask/>
      <file_required>N</file_required>
      <include_subfolders>N</include_subfolders>
      <type>CSV</type>
      <compression>None</compression>
    </file>
    <filters>
    </filters>
    <fields>
      <field>
        <name>status</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <ifnull/>
        <position>-1</position>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>files</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <ifnull/>
        <position>-1</position>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
    </fields>
    <limit>0</limit>
    <error_ignored>N</error_ignored>
    <skip_bad_files>N</skip_bad_files>
    <file_error_field/>
    <file_error_message_field/>
    <error_line_skipped>N</error_line_skipped>
    <error_count_field/>
    <error_fields_field/>
    <error_text_field/>
    <bad_line_files_destination_directory/>
    <bad_line_files_extension>warning</bad_line_files_extension>
    <error_line_files_destination_directory/>
    <error_line_files_extension>error</error_line_files_extension>
    <line_number_files_destination_directory/>
    <line_number_files_extension>line</line_number_files_extension>
    <date_format_lenient>Y</date_format_lenient>
    <date_format_locale>en_US</date_format_locale>
    <shortFileFieldName/>
    <pathFieldName/>
    <hiddenFieldName/>
    <lastModificationTimeFieldName/>
    <uriNameFieldName/>
    <rootUriNameFieldName/>
    <extensionFieldName/>
    <sizeFieldName/>
    <attributes/>
    <GUI>
      <xloc>128</xloc>
      <yloc>128</yloc>
    </GUI>
  </transform>
  <transform>
    <name>sort-commit-file</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>${java.io.tmpdir}</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>Y</unique_rows>
    <fields>
      <field>
        <name>hash</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
      <field>
        <name>file</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
      <field>
        <name>operation</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
      <field>
        <name>extension</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
      <field>
        <name>name</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>1143</xloc>
      <yloc>128</yloc>
    </GUI>
  </transform>
  <transform>
    <name>switch-label</name>
    <type>SwitchCase</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cases>
      <case>
        <target_transform>write-commitoperation-file</target_transform>
        <value>File</value>
      </case>
      <case>
        <target_transform>block-until-commit-file</target_transform>
        <value>Pipeline</value>
      </case>
      <case>
        <target_transform>block-until-commit-pipeline</target_transform>
        <value>Workflow</value>
      </case>
    </cases>
    <fieldname>label</fieldname>
    <use_contains>N</use_contains>
    <attributes/>
    <GUI>
      <xloc>1549</xloc>
      <yloc>128</yloc>
    </GUI>
  </transform>
  <transform>
    <name>write-commitoperation-file</name>
    <type>Neo4JOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>lineage-graph</connection>
    <batch_size>1000</batch_size>
    <key/>
    <create_indexes>N</create_indexes>
    <use_create>N</use_create>
    <only_create_relationships>N</only_create_relationships>
    <returning_graph>N</returning_graph>
    <return_graph_field>graph</return_graph_field>
    <from>
      <read_only_from_node>N</read_only_from_node>
      <labels>
        <label/>
        <value>Commit</value>
      </labels>
      <properties>
        <property>
          <name>commit</name>
          <value>hash</value>
          <type>String</type>
          <primary>Y</primary>
        </property>
      </properties>
    </from>
    <to>
      <read_only_to_node>N</read_only_to_node>
      <labels>
        <label/>
        <value>File</value>
      </labels>
      <properties>
        <property>
          <name>filename</name>
          <value>filename</value>
          <type/>
          <primary>Y</primary>
        </property>
        <property>
          <name>name</name>
          <value>name</value>
          <type/>
          <primary>N</primary>
        </property>
      </properties>
    </to>
    <relationship>operation</relationship>
    <relationship_value/>
    <relprops/>
    <attributes/>
    <GUI>
      <xloc>1752</xloc>
      <yloc>128</yloc>
    </GUI>
  </transform>
  <transform>
    <name>write-commitoperation-pipeline</name>
    <type>Neo4JOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>lineage-graph</connection>
    <batch_size>1000</batch_size>
    <key/>
    <create_indexes>N</create_indexes>
    <use_create>N</use_create>
    <only_create_relationships>N</only_create_relationships>
    <returning_graph>N</returning_graph>
    <return_graph_field>graph</return_graph_field>
    <from>
      <read_only_from_node>N</read_only_from_node>
      <labels>
        <label/>
        <value>Commit</value>
      </labels>
      <properties>
        <property>
          <name>commit</name>
          <value>hash</value>
          <type>String</type>
          <primary>Y</primary>
        </property>
      </properties>
    </from>
    <to>
      <read_only_to_node>N</read_only_to_node>
      <labels>
        <label/>
        <value>Pipeline</value>
      </labels>
      <properties>
        <property>
          <name>filename</name>
          <value>filename</value>
          <type/>
          <primary>Y</primary>
        </property>
        <property>
          <name>name</name>
          <value>name</value>
          <type/>
          <primary>N</primary>
        </property>
      </properties>
    </to>
    <relationship>operation</relationship>
    <relationship_value/>
    <relprops/>
    <attributes/>
    <GUI>
      <xloc>1760</xloc>
      <yloc>256</yloc>
    </GUI>
  </transform>
  <transform>
    <name>write-commitoperation-workflow</name>
    <type>Neo4JOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>lineage-graph</connection>
    <batch_size>1000</batch_size>
    <key/>
    <create_indexes>N</create_indexes>
    <use_create>N</use_create>
    <only_create_relationships>N</only_create_relationships>
    <returning_graph>N</returning_graph>
    <return_graph_field>graph</return_graph_field>
    <from>
      <read_only_from_node>N</read_only_from_node>
      <labels>
        <label/>
        <value>Commit</value>
      </labels>
      <properties>
        <property>
          <name>commit</name>
          <value>hash</value>
          <type>String</type>
          <primary>Y</primary>
        </property>
      </properties>
    </from>
    <to>
      <read_only_to_node>N</read_only_to_node>
      <labels>
        <label/>
        <value>Workflow</value>
      </labels>
      <properties>
        <property>
          <name>filename</name>
          <value>filename</value>
          <type/>
          <primary>Y</primary>
        </property>
        <property>
          <name>name</name>
          <value>name</value>
          <type/>
          <primary>N</primary>
        </property>
      </properties>
    </to>
    <relationship>operation</relationship>
    <relationship_value/>
    <relprops/>
    <attributes/>
    <GUI>
      <xloc>1760</xloc>
      <yloc>384</yloc>
    </GUI>
  </transform>
  <transform>
    <name>replace-slash</name>
    <type>ReplaceString</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <in_stream_name>filename</in_stream_name>
        <out_stream_name/>
        <use_regex>no</use_regex>
        <replace_string>\</replace_string>
        <replace_by_string>/</replace_by_string>
        <set_empty_string>N</set_empty_string>
        <replace_field_by_string/>
        <whole_word>no</whole_word>
        <case_sensitive>no</case_sensitive>
        <is_unicode>no</is_unicode>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>737</xloc>
      <yloc>128</yloc>
    </GUI>
  </transform>
  <transform_error_handling>
  </transform_error_handling>
  <attributes/>
</pipeline>
